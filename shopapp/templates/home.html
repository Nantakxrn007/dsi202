    {% extends "base.html" %}
    {% load static %}

    {% block body_class %}home-page{% endblock %}
    {% block header_class %}sticky-header{% endblock %}

    {% block content %}
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/flash_sale_carousel.css' %}">

    <div class="flash-sale-wrapper">
        <h2>üî• Flash Sale üî•</h2>
        <div class="flash-sale-carousel-container">
            <button class="carousel-control prev-button">
                <h1><</h1>
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="flash-sale-carousel">
                {% for product in flash_sale_products %}
                <div class="flash-sale-item">
                    <a href="{% url 'product_detail' product.id %}">
                        <div class="image-container">
                            <img src="{{ product.image.url }}" alt="{{ product.name }}">
                            {% for sale_info in product.sale_informations.all %}
                                {% if sale_info.is_on_sale %}
                                    {% if sale_info.discount_percentage %}
                                    <div class="discount-badge">‡∏•‡∏î {{ sale_info.discount_percentage }}%</div>
                                    {% endif %}
                                {% endif %}
                            {% empty %}
                                {# No active sale info for this product #}
                            {% endfor %}
                        </div>
                        <div class="info-container">
                            <div class="product-name">{{ product.name }}</div>
                            <div class="price-container">
                                {% if product.original_price %}
                                <span class="original-price">{{ product.original_price }} ‡∏ö‡∏≤‡∏ó</span>
                                {% endif %}
                                <span class="current-price">{{ product.price }} ‡∏ö‡∏≤‡∏ó</span>
                            </div>
                            {% if product.remaining_stock %}
                            <div class="stock-remaining">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ {{ product.remaining_stock }} ‡∏ä‡∏¥‡πâ‡∏ô</div>
                            {% endif %}
                        </div>
                    </a>
                </div>
                {% empty %}
                <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ Flash Sale ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>
                {% endfor %}
            </div>
            <button class="carousel-control next-button">
                <h1>></h1>
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <div class="product-grid">
        {% for product in products %}
        <a href="{% url 'product_detail' product.id %}" class="product-card">
            <img src="{{ product.image.url }}" alt="{{ product.name }}">
            <div class="product-info">
                <div class="product-name">{{ product.name }}</div>
                <div class="product-price">{{ product.price }} ‡∏ö‡∏≤‡∏ó</div>
            </div>
        </a>
        {% endfor %}
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const carousel = document.querySelector('.flash-sale-carousel');
        const prevButton = document.querySelector('.prev-button');
        const nextButton = document.querySelector('.next-button');

        if (prevButton && nextButton && carousel) {
            prevButton.addEventListener('click', function() {
                carousel.scrollLeft -= carousel.offsetWidth - 50; // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
            });

            nextButton.addEventListener('click', function() {
                carousel.scrollLeft += carousel.offsetWidth - 50; // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
            });

            // Optional: ‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏ö (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)
            function updateButtonVisibility() {
                if (carousel.scrollLeft === 0) {
                    prevButton.style.visibility = 'hidden';
                } else {
                    prevButton.style.visibility = 'visible';
                }

                if (carousel.scrollLeft >= carousel.scrollWidth - carousel.offsetWidth) {
                    nextButton.style.visibility = 'hidden';
                } else {
                    nextButton.style.visibility = 'visible';
                }
            }

            carousel.addEventListener('scroll', updateButtonVisibility);
            updateButtonVisibility(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        }
    });

    </script>
    {% endblock %}

